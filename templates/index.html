{% extends "site_base.html" %}
{% block content %}
<h2>Search the archive</h2>
<form>
  <p>
    <input type="search" name="q" value="{{ q }}" style="font-size: 1.2em; width: 60%">
    <input type="submit" value="Search" style="font-size: 1.2em; font-weight: bold; padding: 0.05em 1em;">
  </p>
</form>

{% if results %}
  <p>{{ count }} results <small>(showing {{ results|length }}){% if not_first_page %} <a href="/?q={{ q|urlencode }}">First page</a>{% endif %}</small></p>

  {% for row in results %}
    <div class="result">
      <h2><a href="/page/{{ row.rowid }}/">{{ row.filename }}</a> <a class="page-number" href="/page/{{ row.rowid }}/">page {{ row.page }}</a></h2>
      <p class="folder">{{ row.folder }}/</p>
      <a href="https://sfms-history.imgix.net/{{ row.path }}?page={{ row.page }}&w=1024&auto=format"><img class="result-thumb" src="https://sfms-history.imgix.net/{{ row.path }}?page={{ row.page }}&w=200&auto=format"></a>
      {{ row.highlighted|safe }}
    </div>
  {% endfor %}

  {% if next_token %}
    <p class="next-page"><a href="/?q={{ q|urlencode }}&next={{ next_token|urlencode }}">Next page</a></p>
  {% endif %}

{% else %}
  <h3>Six random pages</h3>
  {% for row in random_pages %}
    <a href="/page/{{ row.rowid }}/" title="{{ row.path }}"><img class="random-page" src="https://sfms-history.imgix.net/{{ row.path }}?page={{ row.page }}&w=200&auto=format" alt="{{ row.text }}"></a>
  {% endfor %}
{% endif %}


{% endblock %}